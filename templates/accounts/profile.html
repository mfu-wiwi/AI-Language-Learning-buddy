{% extends 'base.html' %}

{% block title %}My Profile - AI Language Learning{% endblock %}

{% block content %}
<div class="card">
    <h1>My Profile</h1>
    <p style="color: #666; margin-bottom: 20px;">Update your account details and learning preferences below.</p>

    <form method="post" novalidate>
        {% csrf_token %}
        {% if user_form.non_field_errors %}
        <ul class="errorlist">
            {% for error in user_form.non_field_errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
        {% if profile_form.non_field_errors %}
        <ul class="errorlist">
            {% for error in profile_form.non_field_errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}

        <div style="background: #f5f5f5; padding: 30px; border-radius: 10px; margin-bottom: 30px;">
            <h2 style="color: #667eea; margin-bottom: 20px;">Account Information</h2>

            <div style="display: grid; grid-template-columns: 200px 1fr; gap: 20px; margin-bottom: 20px;">
                <strong>Username:</strong>
                <span style="align-self: center;">{{ user.username }}</span>
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label for="id_email"><strong>Email</strong></label>
                {{ user_form.email }}
                {% if user_form.email.errors %}
                <ul class="errorlist">
                    {% for error in user_form.email.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>

            <div style="display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 20px;">
                <div class="form-group">
                    <label for="id_first_name"><strong>First Name</strong></label>
                    {{ user_form.first_name }}
                    {% if user_form.first_name.errors %}
                    <ul class="errorlist">
                        {% for error in user_form.first_name.errors %}
                        <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>
                <div class="form-group">
                    <label for="id_last_name"><strong>Last Name</strong></label>
                    {{ user_form.last_name }}
                    {% if user_form.last_name.errors %}
                    <ul class="errorlist">
                        {% for error in user_form.last_name.errors %}
                        <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 200px 1fr; gap: 20px; margin-top: 20px;">
                <strong>Member Since:</strong>
                <span>{{ user.date_joined|date:"F d, Y" }}</span>
            </div>

            <div style="display: grid; grid-template-columns: 200px 1fr; gap: 20px; margin-top: 10px;">
                <strong>Last Login:</strong>
                <span>{{ user.last_login|date:"F d, Y H:i" }}</span>
            </div>
        </div>

        <div style="background: #f5f5f5; padding: 30px; border-radius: 10px;">
            <h2 style="color: #667eea; margin-bottom: 20px;">Learning Profile</h2>

            <div class="form-group" style="margin-bottom: 20px;">
                <label for="id_native_language"><strong>Native Language</strong></label>
                {{ profile_form.native_language }}
                {% if profile_form.native_language.errors %}
                <ul class="errorlist">
                    {% for error in profile_form.native_language.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label for="id_learning_language"><strong>Learning Language</strong></label>
                {{ profile_form.learning_language }}
                {% if profile_form.learning_language.errors %}
                <ul class="errorlist">
                    {% for error in profile_form.learning_language.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label for="id_bio"><strong>Bio</strong></label>
                {{ profile_form.bio }}
                {% if profile_form.bio.errors %}
                <ul class="errorlist">
                    {% for error in profile_form.bio.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>

            <div style="display: grid; grid-template-columns: 200px 1fr; gap: 20px; margin-top: 10px;">
                <strong>Profile Created:</strong>
                <span>{{ profile.created_at|date:"F d, Y" }}</span>
            </div>
        </div>

        <div style="margin-top: 30px; display: flex; gap: 15px;">
            <button type="submit" class="btn btn-primary">Save Changes</button>
            <a href="{% url 'chat:dashboard' %}" class="btn btn-secondary">Back to Dashboard</a>
        </div>
    </form>
</div>
{% endblock %}
