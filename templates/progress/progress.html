{% extends 'base.html' %}

{% block title %}My Progress - AI Language Learning{% endblock %}

{% block extra_css %}
<style>
    .progress-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 30px;
    }
    
    .progress-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 15px;
        padding: 30px;
        color: white;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }
    
    .progress-title {
        font-size: 1.5rem;
        font-weight: bold;
        margin-bottom: 20px;
    }
    
    .progress-stats {
        margin-top: 20px;
    }
    
    .stat-row {
        display: flex;
        justify-content: space-between;
        padding: 10px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .stat-row:last-child {
        border-bottom: none;
    }
    
    .stat-label {
        opacity: 0.9;
    }
    
    .stat-value {
        font-weight: bold;
        font-size: 1.2rem;
    }
    
    .overall-stats {
        background: white;
        border-radius: 10px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    }
    
    .overall-stats h2 {
        color: #667eea;
        margin-bottom: 20px;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
    }
    
    .stat-box {
        text-align: center;
        padding: 20px;
        background: #f5f5f5;
        border-radius: 10px;
    }
    
    .stat-box-value {
        font-size: 2.5rem;
        font-weight: bold;
        color: #667eea;
    }
    
    .stat-box-label {
        color: #666;
        margin-top: 10px;
    }
</style>
{% endblock %}

{% block content %}
<div class="overall-stats">
    <h2>Overall Statistics</h2>
    <div class="stats-grid">
        <div class="stat-box">
            <div class="stat-box-value">{{ total_sessions }}</div>
            <div class="stat-box-label">Total Chat Sessions</div>
        </div>
        <div class="stat-box">
            <div class="stat-box-value">{{ progress_list.count }}</div>
            <div class="stat-box-label">Active Categories</div>
        </div>
        <div class="stat-box">
            <div class="stat-box-value">{{ user.date_joined|timesince }}</div>
            <div class="stat-box-label">Member Since</div>
        </div>
    </div>
</div>

<div class="card">
    <h1>Progress by Category</h1>
    
    {% if progress_list %}
    <div class="progress-grid">
        {% for progress in progress_list %}
        <div class="progress-card">
            <div class="progress-title">
                {% if progress.chat_type == 'assistance' %}ðŸ“š
                {% elif progress.chat_type == 'quiz' %}ðŸŽ¯
                {% elif progress.chat_type == 'matching' %}ðŸ”„
                {% endif %}
                {{ progress.get_chat_type_display }}
            </div>
            
            <div class="progress-stats">
                <div class="stat-row">
                    <span class="stat-label">Current Level</span>
                    <span class="stat-value">{{ progress.level }}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Total Sessions</span>
                    <span class="stat-value">{{ progress.total_sessions }}</span>
                </div>
                {% if progress.chat_type == 'quiz' %}
                <div class="stat-row">
                    <span class="stat-label">Average Score</span>
                    <span class="stat-value">{{ progress.quiz_score_avg|floatformat:1 }}%</span>
                </div>
                {% endif %}
                <div class="stat-row">
                    <span class="stat-label">Last Activity</span>
                    <span class="stat-value" style="font-size: 0.9rem;">{{ progress.last_activity|date:"M d, Y" }}</span>
                </div>
            </div>
            
            <div style="margin-top: 20px;">
                <a href="{% url 'chat:create_session' progress.chat_type %}" class="btn btn-secondary" style="width: 100%;">
                    Start New Session
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div style="text-align: center; padding: 50px; color: #999;">
        <p style="font-size: 1.2rem;">No progress data yet.</p>
        <p>Start a chat session to begin tracking your progress!</p>
        <a href="{% url 'chat:dashboard' %}" class="btn btn-primary" style="margin-top: 20px;">Go to Dashboard</a>
    </div>
    {% endif %}
</div>
{% endblock %}
